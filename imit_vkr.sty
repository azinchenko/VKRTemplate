\usepackage[utf8]{inputenc} %кодировка файла макета utf8
\usepackage[T2A]{fontenc}
\usepackage[russian]{babel} 
\usepackage{csquotes}
\usepackage[left=25mm,right=15mm,top=12mm,bottom=20mm]{geometry} %Попытка разобраться с полями страниц
\usepackage{ntheorem} %окружение для настройки теорем 
\usepackage{graphicx} %работа с рисунками
\usepackage[labelsep=period,figurewithin=none,tablewithin=none]{caption} %подписи к объектам (рисунки, таблицы)
\usepackage{listings} %работа с листингами
\usepackage{indentfirst} %отступ первого абзаца в разделе
\usepackage{enumitem} %настройка маркированных и нумерованных списков (см. примеры настройки в тексте)
\usepackage{fancyhdr} %Настройка нумерации страниц
\usepackage{tocloft} %Настройка заголовка для содержания
\usepackage{url} %Правильное отображение url в списке литературы


\usepackage[
bibencoding=auto,
backend=biber,
babel=other,
style=gost-numeric,
language=auto,
sorting=nty,%none
sortcites=true]{biblatex}

%====================================================================
%Настройки макета
%Содержимое этого блока не должно подвергаться изменению
%====================================================================
\selectlanguage{russian}
\setlength{\parindent}{1.25cm}
%------------Разреженность строк
\tolerance=500

%---------Настройка переноса строк url в списке литературы
\def\UrlBreaks{\do\/\do-}

%---------Настройка большого количества картинок на странице
\renewcommand{\topfraction}{1}
\renewcommand{\bottomfraction}{1}
\renewcommand{\textfraction}{0.1}
\setcounter{topnumber}{4}
\setcounter{bottomnumber}{4}
\setcounter{totalnumber}{8} 

%---------Настройка подписей к таблицам
\DeclareCaptionFormat{mplain}{#1#2\par \centering #3\par}
\captionsetup[table]{format=mplain,
justification=raggedleft,%
labelsep=none,%
singlelinecheck=false,%
skip=3pt}

%---------Настройка подписей к таблицам
\captionsetup{figurename=Рисунок}

%Настройка нумерации страниц
\fancyhf{} % clear all header and footers
\renewcommand{\headrulewidth}{0pt} % remove the header rule
\cfoot{\small \thepage}
\pagestyle{fancy}

%Настройка заголовка для содержания
\renewcommand{\cfttoctitlefont}{\hfill\normalfont\large\bfseries}
\renewcommand{\cftaftertoctitle}{\hfill\thispagestyle{empty}} 

%Настройка теорем
\theoremseparator{.}

%---------Команды рубрикации--------------

%Заголовки
\makeatletter
\renewcommand{\section}{\@startsection{section}{1}%
{\parindent}{-3.5ex plus -1ex minus -.2ex}%
{2.3ex plus.2ex}{\normalfont\large\bfseries}}

\renewcommand{\subsection}{\@startsection{subsection}{2}%
{\parindent}{-3.5ex plus -1ex minus -.2ex}%
{1.5ex plus.2ex}{\normalfont\large\bfseries}}

\renewcommand{\subsubsection}{\@startsection{subsubsection}{3}%
{\parindent}{-1.5ex plus -1ex minus -.2ex}%
{0.5ex plus.2ex}{\normalfont\bfseries}}
\makeatother

%Команда уровня главы
\newcommand{\mysection}[1]{
 \newpage
 \refstepcounter{section}
 {
  \section*{Глава \thesection. #1 \raggedright }
 }
 \addcontentsline{toc}{section}{Глава \thesection. #1} 
}

%Команда уровня параграфа
\newcommand{\mysubsection}[1]{
 \refstepcounter{subsection}
 \subsection*{\thesubsection. #1 \raggedright}
 \addcontentsline{toc}{subsection}{\thesubsection. #1}
}

%Команда третьего уровня
\newcommand{\mysubsubsection}[1]{
\refstepcounter{subsubsection}
% \addcontentsline{toc}{subsubsection}{\thesubsubsection. #1}
\subsubsection*{#1 \raggedright}
}

%Оформление Приложений
\newcounter{appendix}
\newcommand{\addappendix}[1]{
 \newpage
 \refstepcounter{appendix} 
 \section*{ПРИЛОЖЕНИЕ \theappendix. \\#1 \raggedright}
 \addcontentsline{toc}{section}{ПРИЛОЖЕНИЕ \theappendix. #1}
}

%Команда ненумерованной главы
\newcommand{\mynonumbersection}[1]{
\newpage
{
	\centering\section*{#1}
}
\addcontentsline{toc}{section}{#1} 
}

%--------Настройка маркированных и нумерованных списков
\setlist{itemsep=0pt,topsep=0pt}

%--------Настройка листингов программного кода
\lstloadlanguages{C,[ANSI]C++}%!настройка листинга
%Можно подключить другие языки (см документацию к пакету listings)

%--------Тонкая настройка листингов
\lstset{
inputencoding=utf8,
extendedchars=false,
showstringspaces=false,
showspaces=false,
keepspaces = true,
basicstyle=\small\ttfamily,
keywordstyle=\bfseries,
tabsize=2,                      % sets default tabsize to 2 spaces
captionpos=t,                   % sets the caption-position to bottom
breaklines=true,                % sets automatic line breaking
breakatwhitespace=true,        % sets if automatic breaks should only happen at whitespace
title=\lstname,                 % show the filename of files included with \lstinputlisting;
basewidth={0.5em,0.45em},
literate={а}{{\selectfont\char224}}1 % для русских комментариев в листинге. Можно удалить за ненадобностью
{б}{{\selectfont\char225}}1
{в}{{\selectfont\char226}}1
{г}{{\selectfont\char227}}1
{д}{{\selectfont\char228}}1
{е}{{\selectfont\char229}}1
{ё}{{\"e}}1
{ж}{{\selectfont\char230}}1
{з}{{\selectfont\char231}}1
{и}{{\selectfont\char232}}1
{й}{{\selectfont\char233}}1
{к}{{\selectfont\char234}}1
{л}{{\selectfont\char235}}1
{м}{{\selectfont\char236}}1
{н}{{\selectfont\char237}}1
{о}{{\selectfont\char238}}1
{п}{{\selectfont\char239}}1
{р}{{\selectfont\char240}}1
{с}{{\selectfont\char241}}1
{т}{{\selectfont\char242}}1
{у}{{\selectfont\char243}}1
{ф}{{\selectfont\char244}}1
{х}{{\selectfont\char245}}1
{ц}{{\selectfont\char246}}1
{ч}{{\selectfont\char247}}1
{ш}{{\selectfont\char248}}1
{щ}{{\selectfont\char249}}1
{ъ}{{\selectfont\char250}}1
{ы}{{\selectfont\char251}}1
{ь}{{\selectfont\char252}}1
{э}{{\selectfont\char253}}1
{ю}{{\selectfont\char254}}1
{я}{{\selectfont\char255}}1
{А}{{\selectfont\char192}}1
{Б}{{\selectfont\char193}}1
{В}{{\selectfont\char194}}1
{Г}{{\selectfont\char195}}1
{Д}{{\selectfont\char196}}1
{Е}{{\selectfont\char197}}1
{Ё}{{\"E}}1
{Ж}{{\selectfont\char198}}1
{З}{{\selectfont\char199}}1
{И}{{\selectfont\char200}}1
{Й}{{\selectfont\char201}}1
{К}{{\selectfont\char202}}1
{Л}{{\selectfont\char203}}1
{М}{{\selectfont\char204}}1
{Н}{{\selectfont\char205}}1
{О}{{\selectfont\char206}}1
{П}{{\selectfont\char207}}1
{Р}{{\selectfont\char208}}1
{С}{{\selectfont\char209}}1
{Т}{{\selectfont\char210}}1
{У}{{\selectfont\char211}}1
{Ф}{{\selectfont\char212}}1
{Х}{{\selectfont\char213}}1
{Ц}{{\selectfont\char214}}1
{Ч}{{\selectfont\char215}}1
{Ш}{{\selectfont\char216}}1
{Щ}{{\selectfont\char217}}1
{Ъ}{{\selectfont\char218}}1
{Ы}{{\selectfont\char219}}1
{Ь}{{\selectfont\char220}}1
{Э}{{\selectfont\char221}}1
{Ю}{{\selectfont\char222}}1
{Я}{{\selectfont\char223}}1
}

%----------Настройка подписей к листингам
\renewcommand{\lstlistingname}{Листинг}

%------------Подключение стиля для оформления списка литературы
\makeatletter
\renewcommand{\@biblabel}[1]{#1.\hfill}
\makeatother
%\bibliographystyle{ugost2003s}
%\PrerenderUnicode{ЙЦУКЕНГШЩЗХЪЭЖДЛОРПАВЫФЯЧСМИТЬБЮйцукенгшщзхъэждлорпавыфячсмитьбю}
\DeclareSourcemap{
  \maps[datatype=bibtex]{
    \map{
      \step[fieldsource=langid, match=russian, final]
      \step[fieldset=presort, fieldvalue={a}]
    }
    \map{
      \step[fieldsource=langid, notmatch=russian, final]
      \step[fieldset=presort, fieldvalue={z}]
    }
  }
}


\DeclareFieldFormat{urldate}{\mkbibparens{\usefont{T2A}{phv}{bc}{n}\bibstring{urlseen}\space%
\printfield{urlday}.\printfield{urlmonth}.\printfield{urlyear}}}

\DefineBibliographyStrings{english}{%
  urlseen =    {дата\addabbrvspace обр\adddot},
}

%\DeclareSourcemap{ %модификация bib файла перед обработкой biblatex
%	\maps{
%		\map[overwrite]{ % формат записи даты
%			\step[fieldsource=urldate,
%			match=\regexp{([0-9]{2})\.([0-9]{2})\.([0-9]{4})},
%			replace={$3-$2-$1$4}, 
%			final]
%		}
%	}
%	\map{% перекидываем значения полей numpages в поля pagetotal, которыми пользуется biblatex
%		\step[fieldsource=numpages, fieldset=pagetotal, origfieldval, final]
%		\step[fieldset=numpages, null]
%	}
%	\map{% перекидываем значения полей pagestotal в поля pagetotal, которыми пользуется biblatex
%		\step[fieldsource=pagestotal, fieldset=pagetotal, origfieldval, final]
%		\step[fieldset=pagestotal, null]
%	}
%}

\renewcommand*{\mkgostheading}[1]{#1}
%====================================================================
%Настройки макета
%Содержимое предыдущего блока не должно подвергаться изменению
%====================================================================
